{% extends "base.html" %}

{% block title %}Freecell 纸牌接龙{% endblock %}

{% block content %}

<head>
    <meta charset="utf-8" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"
        type="text/javascript"></script>
    <script src="{{ url_for('static', filename='freecell.js') }}" type="text/javascript"></script>

    <!-- Add custom animation styles here -->
    <style>
        .card {
            transition: transform 0.1s ease, opacity 0.1s ease;
        }

        img {

            -webkit-user-drag: none;

            -moz-user-drag: none;

            -ms-user-drag: none;

        }

        @keyframes fly-in-from-top-right {
            from {
                opacity: 0;
                transform: translate(50vw, -50vh) scale(0.3);
            }

            to {
                opacity: 1;
                transform: translate(0, 0) scale(1);
            }
        }

        .animate-fly-in {
            opacity: 0;
            /* Start transparently to prevent flash */
            animation: fly-in-from-top-right 0.6s ease-out forwards;
        }
    </style>
    <title>Freecell</title>
</head>

<body class="bg-gray-900 text-white">

    <!-- Main responsive container -->
    <div class="flex flex-col lg:flex-row gap-6 p-4 max-w-screen-2xl mx-auto">

        <!-- Main Game Area -->
        <div class="flex-grow">
            <div id="title" class="text-center my-8">
                <h1 class="text-4xl font-bold">Fre<span id="secret" class="text-blue-500">e</span>cell</h1>
                <p class="mt-2 text-gray-400">Moves: <span id="move-count" class="font-semibold text-white">0</span></p>
                <div class="flex justify-center gap-4 mt-4">
                    <button id="newgame"
                        class="bg-green-500 text-white py-2 px-4 rounded hover:bg-green-600 transition">New
                        Game</button>
                    <button id="undo"
                        class="bg-yellow-500 text-white py-2 px-4 rounded hover:bg-yellow-600 transition">Undo
                        (Ctrl+Z)</button>
                    <button id="help"
                        class="bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 transition">Help</button>
                </div>
            </div>
            <div id="table" class="grid grid-cols-8 gap-4 max-w-6xl mx-auto bg-gray-800 p-6 rounded-lg shadow-lg">
                <!-- Free cells and suits: force aspect ratio 223:324 (w:h) on first row -->
                <div id="free0" class="free bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out">
                    <div class="slot aspect-[223/324] relative"></div>
                </div>
                <div id="free1" class="free bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out">
                    <div class="slot aspect-[223/324] relative"></div>
                </div>
                <div id="free2" class="free bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out">
                    <div class="slot aspect-[223/324] relative"></div>
                </div>
                <div id="free3" class="free bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out">
                    <div class="slot aspect-[223/324] relative"></div>
                </div>
                <div id="suit0" class="suit bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out">
                    <div class="slot aspect-[223/324] relative"></div>
                </div>
                <div id="suit1" class="suit bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out">
                    <div class="slot aspect-[223/324] relative"></div>
                </div>
                <div id="suit2" class="suit bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out">
                    <div class="slot aspect-[223/324] relative"></div>
                </div>
                <div id="suit3" class="suit bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out">
                    <div class="slot aspect-[223/324] relative"></div>
                </div>
                <div id="col0" class="column bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out"></div>
                <div id="col1" class="column bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out"></div>
                <div id="col2" class="column bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out"></div>
                <div id="col3" class="column bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out"></div>
                <div id="col4" class="column bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out"></div>
                <div id="col5" class="column bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out"></div>
                <div id="col6" class="column bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out"></div>
                <div id="col7" class="column bg-gray-700 rounded-lg p-2 transition duration-100 ease-in-out"></div>
            </div>
        </div>

        <!-- Sidebar for History -->
        <div id="sidebar" class="w-full lg:w-64 xl:w-72 flex-shrink-0 bg-gray-800 p-4 rounded-lg shadow-lg">
            <h2 class="text-2xl font-bold mb-4">History</h2>
            <div id="history-list"
                class="h-96 lg:h-[calc(100%-4rem)] overflow-y-auto bg-gray-900 rounded p-2 space-y-1">
                <!-- History items will be dynamically injected here by JavaScript -->
                <div class="text-gray-500 text-center p-4">No moves yet.</div>
            </div>
        </div>

    </div>


    <div id="windialog" class="text-center my-8 bg-gray-800 p-6 rounded-lg shadow-lg">
        <p class="text-xl font-bold">Well done, you have won!</p>
    </div>

    <div id="helptext" class="max-w-4xl mx-auto bg-gray-800 p-6 rounded-lg shadow-lg">
        <p class="text-lg mb-4">
            FreeCell is a solitaire-based card game played with a 52-card standard deck.
            It is fundamentally different from most solitaire games in that nearly all
            deals can be solved.
        </p>
        <p class="text-lg font-semibold">Construction and layout:</p>
        <ul class="list-disc list-inside text-gray-300 mb-4">
            <li>One standard 52-card deck is used.</li>
            <li>There are four open cells and four open foundations. Some alternate
                rules use between one to ten cells.</li>
            <li>Cards are dealt into eight cascades, four of which comprise seven cards
                and four of which comprise six. Some alternate rules will use between four to ten cascades.</li>
        </ul>
        <p class="text-lg font-semibold">Building during play:</p>
        <ul class="list-disc list-inside text-gray-300 mb-4">
            <li>The top card of each cascade begins a tableau.</li>
            <li>Tableaux must be built down by alternating colors.</li>
            <li>Foundations are built up by suit.</li>
        </ul>
        <p class="text-lg font-semibold">Moves:</p>
        <ul class="list-disc list-inside text-gray-300 mb-4">
            <li>Any cell card or top card of any cascade may be moved to build on a
                tableau, or moved to an empty cell, an empty cascade, or its foundation.</li>
            <li>Complete or partial tableaus may be moved to build on existing tableaus,
                or moved to empty cascades, by recursively placing and removing cards
                through intermediate locations. While computer implementations often show
                this motion, players using physical decks typically move the tableau at
                once.</li>
        </ul>
        <p class="text-lg font-semibold">Victory:</p>
        <ul class="list-disc list-inside text-gray-300 mb-4">
            <li>The game is won after all cards are moved to their foundation piles.</li>
        </ul>
        <p class="text-gray-300">Rules from <a href="http://en.wikipedia.org/wiki/Freecell"
                class="text-blue-500 hover:underline">Wikipedia.</a></p>
    </div>

</body>

{% endblock %}